{"version":3,"file":"PluginSlot.js","names":["_react","_interopRequireWildcard","require","_classnames","_interopRequireDefault","_paragon","_propTypes","_i18n","_Plugin","_hooks","_PluginContainer","_utils","_shapes","_jsxRuntime","_excluded","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","value","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","_objectWithoutProperties","_objectWithoutPropertiesLoose","indexOf","propertyIsEnumerable","BasePluginSlot","_ref","ref","as","React","Fragment","children","id","id_aliases","pluginProps","slotOptions","slotErrorFallbackComponent","props","keepDefault","plugins","usePluginSlot","formatMessage","useIntl","defaultContents","useMemo","priority","RenderWidget","finalPlugins","organizePlugins","loadingFallback","defaultLoadingFallback","jsx","className","classNames","Spinner","animation","screenReaderText","messages","loading","finalLoadingFallback","undefined","finalChildren","pluginConfig","hidden","container","propsForRenderWidget","isValidElement","updatedPropsForRenderWidget","mergeRenderWidgetPropsWithPluginContent","pluginSlotOptions","renderWidgetProps","cloneElement","key","config","wrappers","wrapComponent","createElement","propTypes","PropTypes","elementType","node","string","isRequired","arrayOf","shape","slotOptionsShape","PluginSlot","forwardRef","displayName","_default","exports"],"sources":["../../src/plugins/PluginSlot.jsx"],"sourcesContent":["import React, { forwardRef } from 'react';\nimport classNames from 'classnames';\nimport { Spinner } from '@openedx/paragon';\nimport PropTypes from 'prop-types';\nimport { useIntl } from '@edx/frontend-platform/i18n';\n\nimport messages from './Plugin.messages';\nimport { usePluginSlot } from './data/hooks';\nimport PluginContainer from './PluginContainer';\nimport { mergeRenderWidgetPropsWithPluginContent, organizePlugins, wrapComponent } from './data/utils';\nimport { slotOptionsShape } from './data/shapes';\n\nfunction BasePluginSlot({\n  as = React.Fragment,\n  children = null,\n  id,\n  id_aliases = [],\n  pluginProps = {},\n  slotOptions = {},\n  slotErrorFallbackComponent,\n  ...props\n}, ref) {\n  /** the plugins below are obtained by the id passed into PluginSlot by the Host MFE. See example/src/PluginsPage.jsx\n  for an example of how PluginSlot is populated, and example/src/index.jsx for a dummy JS config that holds all plugins\n  */\n\n  const { keepDefault, plugins } = usePluginSlot(id, id_aliases);\n  const { formatMessage } = useIntl();\n\n  const defaultContents = React.useMemo(() => {\n    if (!keepDefault) {\n      return [];\n    }\n    return ([{\n      id: 'default_contents',\n      priority: 50,\n      RenderWidget: children,\n    }]);\n  }, [children, keepDefault]);\n\n  const finalPlugins = React.useMemo(() => organizePlugins(defaultContents, plugins), [defaultContents, plugins]);\n\n  // TODO: Unique plugin props\n  // https://github.com/openedx/frontend-plugin-framework/issues/72\n  const { loadingFallback } = pluginProps;\n\n  const defaultLoadingFallback = (\n    <div className={classNames(pluginProps.className, 'd-flex justify-content-center align-items-center')}>\n      <Spinner animation=\"border\" screenReaderText={formatMessage(messages.loading)} />\n    </div>\n  );\n\n  const finalLoadingFallback = loadingFallback !== undefined\n    ? loadingFallback\n    : defaultLoadingFallback;\n\n  const finalChildren = [];\n  if (finalPlugins.length > 0) {\n    finalPlugins.forEach((pluginConfig) => {\n      // If hidden, don't push to finalChildren\n      if (!pluginConfig.hidden) {\n        let container;\n        // If default content, render children (merging any custom defined props from\n        // pluginConfig.content with any existing props on `RenderWidget`).\n        if (pluginConfig.id === 'default_contents') {\n          const propsForRenderWidget = (pluginConfig.RenderWidget && React.isValidElement(pluginConfig.RenderWidget))\n            ? pluginConfig.RenderWidget.props\n            : {};\n          const updatedPropsForRenderWidget = mergeRenderWidgetPropsWithPluginContent({\n            pluginSlotOptions: slotOptions,\n            pluginConfig,\n            pluginProps,\n            renderWidgetProps: propsForRenderWidget,\n          });\n          container = React.isValidElement(pluginConfig.RenderWidget)\n            ? React.cloneElement(pluginConfig.RenderWidget, { ...updatedPropsForRenderWidget, key: pluginConfig.id })\n            : pluginConfig.RenderWidget;\n        } else {\n          container = (\n            <PluginContainer\n              key={pluginConfig.id}\n              config={pluginConfig}\n              loadingFallback={finalLoadingFallback}\n              slotErrorFallbackComponent={slotErrorFallbackComponent}\n              slotOptions={slotOptions}\n              {...pluginProps}\n            />\n          );\n        }\n        // If wrappers are provided, wrap the Plugin\n        if (pluginConfig.wrappers) {\n          finalChildren.push(\n            wrapComponent(\n              () => container,\n              pluginConfig.wrappers,\n            ),\n          );\n        } else {\n          finalChildren.push(container);\n        }\n      }\n    });\n  }\n\n  return React.createElement(\n    as,\n    {\n      ...props,\n      ref,\n    },\n    finalChildren,\n  );\n}\n\nBasePluginSlot.propTypes = {\n  /** Element type for the PluginSlot wrapper component */\n  as: PropTypes.elementType,\n  /** Default children for the PluginSlot */\n  children: PropTypes.node,\n  /** ID of the PluginSlot configuration */\n  id: PropTypes.string.isRequired,\n  /** Aliases (additional IDs for the PluginSlot) */\n  id_aliases: PropTypes.arrayOf(PropTypes.string),\n  /** Props that are passed down to each Plugin in the Slot */\n  pluginProps: PropTypes.shape(),\n  /** Options passed to the PluginSlot */\n  slotOptions: PropTypes.shape(slotOptionsShape),\n  /** Error fallback component to use for each plugin */\n  slotErrorFallbackComponent: PropTypes.node,\n};\n\nconst PluginSlot = forwardRef(BasePluginSlot);\nPluginSlot.displayName = 'PluginSlot';\n\nexport default PluginSlot;\n"],"mappings":"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","ignoreList":[]}