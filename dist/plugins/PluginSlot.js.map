{"version":3,"file":"PluginSlot.js","names":["_react","_interopRequireWildcard","require","_classnames","_interopRequireDefault","_paragon","_propTypes","_i18n","_Plugin","_hooks","_PluginContainer","_utils","_shapes","_jsxRuntime","_excluded","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","key","value","_toPropertyKey","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","prototype","propertyIsEnumerable","PluginSlot","forwardRef","_ref","ref","as","children","id","pluginProps","slotOptions","props","keepDefault","plugins","usePluginSlot","formatMessage","useIntl","defaultContents","React","useMemo","priority","RenderWidget","finalPlugins","organizePlugins","loadingFallback","defaultLoadingFallback","jsx","className","classNames","Spinner","animation","screenReaderText","messages","loading","finalLoadingFallback","undefined","finalChildren","pluginConfig","hidden","container","propsForRenderWidget","isValidElement","updatedPropsForRenderWidget","mergeRenderWidgetPropsWithPluginContent","pluginSlotOptions","renderWidgetProps","cloneElement","config","wrappers","wrapComponent","createElement","displayName","_default","exports","propTypes","PropTypes","elementType","node","string","isRequired","shape","slotOptionsShape","defaultProps","Fragment"],"sources":["../../src/plugins/PluginSlot.jsx"],"sourcesContent":["import React, { forwardRef } from 'react';\n\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport classNames from 'classnames';\nimport { Spinner } from '@openedx/paragon';\nimport PropTypes from 'prop-types';\nimport { useIntl } from '@edx/frontend-platform/i18n';\n\nimport messages from './Plugin.messages';\nimport { usePluginSlot } from './data/hooks';\nimport PluginContainer from './PluginContainer';\nimport { mergeRenderWidgetPropsWithPluginContent, organizePlugins, wrapComponent } from './data/utils';\nimport { slotOptionsShape } from './data/shapes';\n\nconst PluginSlot = forwardRef(({\n  as,\n  children,\n  id,\n  pluginProps,\n  slotOptions,\n  ...props\n}, ref) => {\n  /** the plugins below are obtained by the id passed into PluginSlot by the Host MFE. See example/src/PluginsPage.jsx\n  for an example of how PluginSlot is populated, and example/src/index.jsx for a dummy JS config that holds all plugins\n  */\n\n  const { keepDefault, plugins } = usePluginSlot(id);\n  const { formatMessage } = useIntl();\n\n  const defaultContents = React.useMemo(() => {\n    if (!keepDefault) {\n      return [];\n    }\n    return ([{\n      id: 'default_contents',\n      priority: 50,\n      RenderWidget: children,\n    }]);\n  }, [children, keepDefault]);\n\n  const finalPlugins = React.useMemo(() => organizePlugins(defaultContents, plugins), [defaultContents, plugins]);\n\n  // TODO: APER-3178 â€” Unique plugin props\n  // https://2u-internal.atlassian.net/browse/APER-3178\n  const { loadingFallback } = pluginProps;\n\n  const defaultLoadingFallback = (\n    <div className={classNames(pluginProps.className, 'd-flex justify-content-center align-items-center')}>\n      <Spinner animation=\"border\" screenReaderText={formatMessage(messages.loading)} />\n    </div>\n  );\n\n  const finalLoadingFallback = loadingFallback !== undefined\n    ? loadingFallback\n    : defaultLoadingFallback;\n\n  const finalChildren = [];\n  if (finalPlugins.length > 0) {\n    finalPlugins.forEach((pluginConfig) => {\n      // If hidden, don't push to finalChildren\n      if (!pluginConfig.hidden) {\n        let container;\n        // If default content, render children (merging any custom defined props from\n        // pluginConfig.content with existing props, if any, on `RenderWidget`).\n        if (pluginConfig.id === 'default_contents') {\n          const propsForRenderWidget = (pluginConfig.RenderWidget && React.isValidElement(pluginConfig.RenderWidget))\n            ? pluginConfig.RenderWidget.props\n            : {};\n          const updatedPropsForRenderWidget = mergeRenderWidgetPropsWithPluginContent({\n            pluginSlotOptions: slotOptions,\n            pluginConfig,\n            pluginProps,\n            renderWidgetProps: propsForRenderWidget,\n          });\n          container = React.isValidElement(pluginConfig.RenderWidget)\n            ? React.cloneElement(pluginConfig.RenderWidget, { ...updatedPropsForRenderWidget, key: pluginConfig.id })\n            : pluginConfig.RenderWidget;\n        } else {\n          container = (\n            <PluginContainer\n              key={pluginConfig.id}\n              config={pluginConfig}\n              loadingFallback={finalLoadingFallback}\n              slotOptions={slotOptions}\n              {...pluginProps}\n            />\n          );\n        }\n        // If wrappers are provided, wrap the Plugin\n        if (pluginConfig.wrappers) {\n          finalChildren.push(\n            wrapComponent(\n              () => container,\n              pluginConfig.wrappers,\n            ),\n          );\n        } else {\n          finalChildren.push(container);\n        }\n      }\n    });\n  }\n\n  return React.createElement(\n    as,\n    {\n      ...props,\n      ref,\n    },\n    finalChildren,\n  );\n});\nPluginSlot.displayName = 'PluginSlot';\n\nexport default PluginSlot;\n\nPluginSlot.propTypes = {\n  /** Element type for the PluginSlot wrapper component */\n  as: PropTypes.elementType,\n  /** Default children for the PluginSlot */\n  children: PropTypes.node,\n  /** ID of the PluginSlot configuration */\n  id: PropTypes.string.isRequired,\n  /** Props that are passed down to each Plugin in the Slot */\n  pluginProps: PropTypes.shape(),\n  /** Options passed to the PluginSlot */\n  slotOptions: PropTypes.shape(slotOptionsShape),\n};\n\nPluginSlot.defaultProps = {\n  as: React.Fragment,\n  children: null,\n  pluginProps: {},\n  slotOptions: {},\n};\n"],"mappings":"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","ignoreList":[]}